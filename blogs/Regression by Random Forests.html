<!DOCTYPE html>
<html>
	<head>
		<title>Regression with Random Forest</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="format-detection" content="telephone=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<!-- Fonts-->
		<link rel="stylesheet" type="text/css" href="../assets/fonts/fontawesome/font-awesome.min.css">
		<link rel="stylesheet" type="text/css" href="../assets/fonts/pe-icon/pe-icon.css">
		<!-- Vendors-->
		<link rel="stylesheet" type="text/css" href="../assets/vendors/bootstrap/grid.css">
		<link rel="stylesheet" type="text/css" href="../assets/vendors/magnific-popup/magnific-popup.min.css">
		<link rel="stylesheet" type="text/css" href="../assets/vendors/swiper/swiper.css">
		<!-- App & fonts-->
		<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700|Open+Sans:400,700">
		<link rel="stylesheet" type="text/css" id="app-stylesheet" href="../assets/css/main.css"><!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<![endif]-->
		<!-- Favicon -->
		<link rel="shortcut icon" href="../assets/img/favicon.png">

	</head>
	
	<body>
		<div class="page-wrap" id="root">
			
			<!-- header -->
			<header class="header header--fixed">
				<div class="header__inner">
					<div class="header__logo"><a href="../index.html"><img src="../assets/img/logo.png" alt="" style="width: 180px;"/></a></div>
					<div class="navbar-toggle" id="fs-button">
						<div class="navbar-icon"><span></span></div>
					</div>
				</div>
				
				<!-- fullscreenmenu__module -->
				<div class="fullscreenmenu__module" trigger="#fs-button">
					
					<!-- overlay-menu -->
					<nav class="overlay-menu">
						
						<!-- Navbar -->
						<ul class="wil-menu-list">
							<li class="current-menu-item"><a href="../index.html">Home</a>
							</li>
							<li><a href="../about.html">About</a>
							</li>
							<li><a href="../projects.html">Projects</a>
							</li>
							<li><a href="../blog.html">Blog</a>
							</li>
							<li><a href="../contact.html">Contact</a>
							</li>
						</ul><!-- End Navbar -->
						
					</nav><!-- End / overlay-menu -->
					
				</div><!-- End / fullscreenmenu__module -->
				
			</header><!-- End / header -->
			
			<!-- Content-->
			<div class="wil-content">
				
				<!-- Section -->
				<section class="awe-section">
					<div class="container">
						
						<!-- page-title -->
						<div class="page-title pb-40">
							<span class="post-detail__cat">Scikit-learn</span>
							<h2 class="page-title__title">Regression with Random Forest</h2>
							<div class="post-detail__meta"><span class="date">Dec 26, 2018</span><span class="author"><a href="../about.html">by Pratyaksha Jha</a></span></div>
							<div class="page-title__divider"></div>
						</div><!-- End / page-title -->
						
					</div>
				</section>
				<!-- End / Section -->
				
				
				<!-- Section -->
				<section class="awe-section bg-gray">
					<div class="container">
						
						<!--  -->
						<div>
							<div class="post-detail__media"><img src="../assets/img/Regression with Random Forest.jpg" alt=""/></div>
							<a style="background-color:#333;color:white;text-decoration:none;padding:4px 6px;font-family:-apple-system, BlinkMacSystemFont, &quot;San Francisco&quot;, &quot;Helvetica Neue&quot;, Helvetica, Ubuntu, Roboto, Noto, &quot;Segoe UI&quot;, Arial, sans-serif;font-size:12px;font-weight:bold;line-height:1.2;display:inline-block;border-radius:3px" href="https://unsplash.com/@geran?utm_medium=referral&amp;utm_campaign=photographer-credit&amp;utm_content=creditBadge" target="_blank" rel="noopener noreferrer" title="Download free do whatever you want high-resolution photos from Geran de Klerk"><span style="display:inline-block;padding:2px 3px"><svg xmlns="http://www.w3.org/2000/svg" style="height:12px;width:auto;position:relative;vertical-align:middle;top:-1px;fill:white" viewBox="0 0 32 32"><title>unsplash-logo</title><path d="M20.8 18.1c0 2.7-2.2 4.8-4.8 4.8s-4.8-2.1-4.8-4.8c0-2.7 2.2-4.8 4.8-4.8 2.7.1 4.8 2.2 4.8 4.8zm11.2-7.4v14.9c0 2.3-1.9 4.3-4.3 4.3h-23.4c-2.4 0-4.3-1.9-4.3-4.3v-15c0-2.3 1.9-4.3 4.3-4.3h3.7l.8-2.3c.4-1.1 1.7-2 2.9-2h8.6c1.2 0 2.5.9 2.9 2l.8 2.4h3.7c2.4 0 4.3 1.9 4.3 4.3zm-8.6 7.5c0-4.1-3.3-7.5-7.5-7.5-4.1 0-7.5 3.4-7.5 7.5s3.3 7.5 7.5 7.5c4.2-.1 7.5-3.4 7.5-7.5z"></path></svg></span><span style="display:inline-block;padding:2px 3px">Picture by Geran de Klerk</span></a>
							<hr>
							<div class="post-detail__entry row">
								<div class="col-md-11">
									<h5>What exactly is Random Forest? How to implement it?</h5>
									<p>In this post, we&#39;ll have a look at machine learning process with focus on Random Forest algorithm. Most common ML steps are:</p>
									<ul>
									<li>Get the data</li>
									<li>Analyse the data</li>
									<li>Transform data</li>
									<li>Shortlist algorithms</li>
									<li>Tune algorithm</li>
									<li>Evaluate</li>
									</ul></p>
									<p>In the 4th step, random forest was a clear winner. A little bit on Random Forest first and then we move on to the code.</p>
									<p>Random forest are one of the most powerful and versatile ML algorithms. It is an ensemble technique i.e. instead of a single regressor, several of them are used. It trains various decision trees on subsets of the training data and then averages out the result of trees for prediction. Instead of putting resources in training a single strong decision tree, a set of decision trees (hence the name <em>forest</em>) which are strong for a small subset of data are trained. An important reason why it works so well is that it can easily map complex relationships between attributes. </p>
									<p>The image example here shows how it works in case of classification. Difference between classification and regression is the way of selecting the prediction. For example, regression can use mean of all predictions while classification can choose the mode class in all classifiers.</p>
									<img src="img/rf.gif" alt="Random Forests"></p>
									<p>The loading part is quite straight forward, by using dataframe from pandas. Eyeball the data to have a quick idea about the data. <code>df.info()</code> gives us information about data types, missing values, column names, etc. <code>df.describe()</code> gives a statistical summary of numerical features.
									Histograms gives information about distribution of data, any outliers, missing data and abnormal values. 
									Correlation matrix is important as it helps to determine important features and useless features. Do not forget that </p>
									<b><p>Correlation does not mean causation.</p></b>
									<script src="https://gist.github.com/pratyakshajha/3f951d78b995124cb67c9e21d6b3135b.js"></script>

									<p>From correlation values, <code>CHAS</code> and <code>DIS</code> have small correlation with our target feature, so we drop it. After this, split into training and test data.
									Using <code>StandardScaler</code>, we scale data as these algorithms are pretty sensitive to scaling.</p>
									<script src="https://gist.github.com/pratyakshajha/eaa38ae44355379de1fd123564ac3e46.js"></script>

									<p>Shortlist several regressors that usually perform well to shortlist the best model. After cross validating each regressor, it outputs a message that gives mean error and standard deviation of error in brackets. </p>
									<script src="https://gist.github.com/pratyakshajha/8003ecaf4b3b6a9d2d8648fecf3bb1b8.js"></script>

									<p>Notice that random forest and extra trees regressor give almost half the error rate of decision tree. Extra Trees Regressor gives the best performance. Extra Trees Regressor or extremely randomized trees are a modified version of random forest as they are more randomized. Due to high randomisation, they tend to be faster and work well with noisy data. Further tune this algorithm now.</p>
									<p>For tuning, grid search cross validation and randomized search cross validation are pretty useful. In grid search cross validation, provide a list of values for hyperparameters. It runs cross validation for each and every value. Hence, it is slower. Randomized search cross validation selects any random set of hyperparameters and run cross validation. Both of them fit the regressor to lowest error value, randomized search cross validation is quicker. Since, it is randomized, it can miss some better combinations but most of the times it gives least error. On timing it, randomized search cross validation is more than twice as fast as grid search cross validation with similar error rate.</p>
									<script src="https://gist.github.com/pratyakshajha/d1cb98cb8d10d4468e2988e59597a26d.js"></script>

									<p>Now, evaluate and save the model. For evaluation, use mean square error. Through this post, now you can get your own random forest algorithm up and running quickly.</p>
									<p>Accompanying GitHub repository <a href="https://github.com/pratyakshajha/Machine-Learning-Problems">link</a>.</p>
								</div>
							</div>
							<div class="sharebox__module">
								<p class="social-text">share this article</p>
								
								<!-- social-icon -->
								<a class="social-icon" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fjonsuh.com%2F&title=Jonathan%20Suh&source=https%3A%2F%2Fjonsuh.com%2F&summary=Short%20summary"
									onclick="window.open(this.href, 'Snopzer','left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="social-icon__icon fa fa-linkedin"></i>
								</a><!-- End / social-icon -->
								
								
								<!-- social-icon -->
								<a class="social-icon" href="https://www.facebook.com/sharer/sharer.php?u=URL_TO_SHARE" 
									onclick="window.open(this.href, 'Snopzer',
								'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><i class="social-icon__icon fa fa-facebook"></i>
								</a><!-- End / social-icon -->
								
								
								<!-- social-icon -->
								<a class="social-icon" href="https://twitter.com/intent/tweet?text=TWEET_TO_SHARE&url=URL_TO_SHARE&via=USERNAME_TO_SHARE" 
									onclick="window.open(this.href, 'Snopzer',
								'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="social-icon__icon fa fa-twitter"></i>
								</a><!-- End / social-icon -->
								
																
								<!-- social-icon -->
								<a class="social-icon" href="https://wa.me/?text=urlencodedtext"
								onclick="window.open(this.href, 'Snopzer','left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="social-icon__icon fa fa-whatsapp"></i>
								</a><!-- End / social-icon -->


								<!-- social-icon -->
								<a class="social-icon" href="https://plus.google.com/share?url=https%3A%2F%2Fjonsuh.com%2F"
									onclick="window.open(this.href, 'Snopzer','left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="social-icon__icon fa fa-google-plus"></i>
								</a><!-- End / social-icon -->


								<!-- social-icon -->
								<a class="social-icon" href="https://www.pinterest.com/pin/create/button/?url=https%3A%2F%2Fjonsuh.com%2F&media=https%3A%2F%2Fjonsuh.com%2Ficon.png&description=Short%20description&hashtags=web,development"
									onclick="window.open(this.href, 'Snopzer','left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="social-icon__icon fa fa-pinterest-p"></i>
								</a><!-- End / social-icon -->								
																
							</div>
						</div><!-- End /  -->
						
						<div class="awe-text-center mt-50">
							<a class="md-btn md-btn--outline-primary " href="../blog.html">See all blogs</a>
						</div>
					</div>
				</section>
				<!-- End / Section -->
				
			</div>
			<!-- End / Content-->
			
			<!-- footer -->
			<div class="footer">
				<div class="container">
					<div class="row">
						<div class="col-md-6 col-lg-6 ">						

							<p class="footer__links">
								<a href="../index.html"
								style="color: #333333;">Home</a> ·
								<a href="../about.html"
								style="color: #333333;"> About</a> ·
								<a href="../projects.html"
								style="color: #333333;"> Projects</a> · 
								<a href="../blog.html"
								style="color: #333333;"> Blog</a> · 
								<a href="../contact.html"
								style="color: #333333;"> Contact</a> 
							</p>

							<p class="footer__coppy">Created with freebie template from <a href="http://awe7.com/">Awe7</a>.</p>
						</div>

						<div class="col-md-6 col-lg-6 ">
							<div class="footer__social">
								
								<!-- social-icon -->
								<a class="social-icon" href="https://linkedin.com/in/pratyakshajha/"
									onclick="window.open(this.href, 'Snopzer','left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="social-icon__icon fa fa-linkedin"></i>
								</a><!-- End / social-icon -->
								
												
								<!-- social-icon -->
								<a class="social-icon" href="https://github.com/pratyakshajha"
									onclick="window.open(this.href, 'Snopzer','left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="social-icon__icon fa fa-github"></i>
								</a><!-- End / social-icon -->
								
							</div>
						</div>
					</div>
				</div>
			</div><!-- End / footer -->
			
		</div>
		<!-- Vendors-->
		<script type="text/javascript" src="../assets/vendors/jquery/jquery.min.js"></script>
		<script type="text/javascript" src="../assets/vendors/imagesloaded/imagesloaded.pkgd.js"></script>
		<script type="text/javascript" src="../assets/vendors/isotope-layout/isotope.pkgd.js"></script>
		<script type="text/javascript" src="../assets/vendors/jquery-one-page/jquery.nav.min.js"></script>
		<script type="text/javascript" src="../assets/vendors/jquery.easing/jquery.easing.min.js"></script>
		<script type="text/javascript" src="../assets/vendors/jquery.matchHeight/jquery.matchHeight.min.js"></script>
		<script type="text/javascript" src="../assets/vendors/magnific-popup/jquery.magnific-popup.min.js"></script>
		<script type="text/javascript" src="../assets/vendors/masonry-layout/masonry.pkgd.js"></script>
		<script type="text/javascript" src="../assets/vendors/jquery.waypoints/jquery.waypoints.min.js"></script>
		<script type="text/javascript" src="../assets/vendors/swiper/swiper.jquery.js"></script>
		<script type="text/javascript" src="../assets/vendors/menu/menu.js"></script>
		<script type="text/javascript" src="../assets/vendors/typed/typed.min.js"></script>
		<!-- App-->
		<script type="text/javascript" src="../assets/js/main.js"></script>
	</body>
</html>